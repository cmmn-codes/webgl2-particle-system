function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},i=r.parcelRequire6b8f;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},r.parcelRequire6b8f=i),i.register("27Lyk",(function(t,r){var n,o;e(t.exports,"register",(()=>n),(e=>n=e)),e(t.exports,"resolve",(()=>o),(e=>o=e));var i={};n=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)i[t[r]]=e[t[r]]},o=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),i("27Lyk").register(JSON.parse('{"5CZhm":"index.ecd37f9d.js","7xKxR":"text.835d3710.png","hHIMw":"logo.62830d36.png"}'));var a;a=new URL(i("27Lyk").resolve("7xKxR"),import.meta.url).toString();var u;u=new URL(i("27Lyk").resolve("hHIMw"),import.meta.url).toString();
/* @license twgl.js 5.0.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */
let s=Float32Array;function l(e,t,r){const n=new s(3);return e&&(n[0]=e),t&&(n[1]=t),r&&(n[2]=r),n}function c(e,t,r){return(r=r||new s(3))[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function f(e,t,r){return(r=r||new s(3))[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}let m=Float32Array;function d(e){return(e=e||new m(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function p(e,t){t=t||new m(16);const r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],d=e[10],p=e[11],y=e[12],b=e[13],h=e[14],x=e[15],g=d*x,v=h*p,F=s*x,E=h*l,A=s*p,w=d*l,T=o*x,P=h*i,_=o*p,R=d*i,S=o*l,I=s*i,C=c*b,B=y*f,M=a*b,D=y*u,U=a*f,z=c*u,L=r*b,O=y*n,k=r*f,N=c*n,V=r*u,j=a*n,H=g*u+E*f+A*b-(v*u+F*f+w*b),W=v*n+T*f+R*b-(g*n+P*f+_*b),G=F*n+P*u+S*b-(E*n+T*u+I*b),$=w*n+_*u+I*f-(A*n+R*u+S*f),Y=1/(r*H+a*W+c*G+y*$);return t[0]=Y*H,t[1]=Y*W,t[2]=Y*G,t[3]=Y*$,t[4]=Y*(v*a+F*c+w*y-(g*a+E*c+A*y)),t[5]=Y*(g*r+P*c+_*y-(v*r+T*c+R*y)),t[6]=Y*(E*r+T*a+I*y-(F*r+P*a+S*y)),t[7]=Y*(A*r+R*a+S*c-(w*r+_*a+I*c)),t[8]=Y*(C*l+D*p+U*x-(B*l+M*p+z*x)),t[9]=Y*(B*i+L*p+N*x-(C*i+O*p+k*x)),t[10]=Y*(M*i+O*l+V*x-(D*i+L*l+j*x)),t[11]=Y*(z*i+k*l+j*p-(U*i+N*l+V*p)),t[12]=Y*(M*d+z*h+B*s-(U*h+C*s+D*d)),t[13]=Y*(k*h+C*o+O*d-(L*d+N*h+B*o)),t[14]=Y*(L*s+j*h+D*o-(V*h+M*o+O*s)),t[15]=Y*(V*d+U*o+N*s-(k*s+j*d+z*o)),t}function y(e,t,r){r=r||l();const n=t[0],o=t[1],i=t[2],a=n*e[3]+o*e[7]+i*e[11]+e[15];return r[0]=(n*e[0]+o*e[4]+i*e[8]+e[12])/a,r[1]=(n*e[1]+o*e[5]+i*e[9]+e[13])/a,r[2]=(n*e[2]+o*e[6]+i*e[10]+e[14])/a,r}function b(e,t,r){r=r||l();const n=t[0],o=t[1],i=t[2];return r[0]=n*e[0]+o*e[4]+i*e[8],r[1]=n*e[1]+o*e[5]+i*e[9],r[2]=n*e[2]+o*e[6]+i*e[10],r}const h={};{const e=h;e[5120]=Int8Array,e[5121]=Uint8Array,e[5122]=Int16Array,e[5123]=Uint16Array,e[5124]=Int32Array,e[5125]=Uint32Array,e[5126]=Float32Array,e[32819]=Uint16Array,e[32820]=Uint16Array,e[33635]=Uint16Array,e[5131]=Uint16Array,e[33640]=Uint32Array,e[35899]=Uint32Array,e[35902]=Uint32Array,e[36269]=Uint32Array,e[34042]=Uint32Array}function x(e){if(e instanceof Int8Array)return 5120;if(e instanceof Uint8Array)return 5121;if(e instanceof Uint8ClampedArray)return 5121;if(e instanceof Int16Array)return 5122;if(e instanceof Uint16Array)return 5123;if(e instanceof Int32Array)return 5124;if(e instanceof Uint32Array)return 5125;if(e instanceof Float32Array)return 5126;throw new Error("unsupported typed array type")}function g(e){if(e===Int8Array)return 5120;if(e===Uint8Array)return 5121;if(e===Uint8ClampedArray)return 5121;if(e===Int16Array)return 5122;if(e===Uint16Array)return 5123;if(e===Int32Array)return 5124;if(e===Uint32Array)return 5125;if(e===Float32Array)return 5126;throw new Error("unsupported typed array type")}function v(e){const t=h[e];if(!t)throw new Error("unknown gl type");return t}const F="undefined"!=typeof SharedArrayBuffer?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function E(...e){console.error(...e)}function A(e,t){return"undefined"!=typeof WebGLRenderbuffer&&t instanceof WebGLRenderbuffer}function w(e,t){return"undefined"!=typeof WebGLTexture&&t instanceof WebGLTexture}const T={attribPrefix:""};function P(e,t,r,n,o){e.bindBuffer(t,r),e.bufferData(t,n,o||35044)}function _(e,t,r,n){if(o=t,"undefined"!=typeof WebGLBuffer&&o instanceof WebGLBuffer)return t;var o;r=r||34962;const i=e.createBuffer();return P(e,r,i,t,n),i}function R(e){return"indices"===e}function S(e){return e.length?e:e.data}const I=/coord|texture/i,C=/color|colour/i;function B(e,t){let r;if(r=I.test(e)?2:C.test(e)?4:3,t%r>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${r} but ${t} values is not evenly divisible by ${r}. You should specify it.`);return r}function M(e,t){return e.numComponents||e.size||B(t,S(e).length)}function D(e,t){if(F(e))return e;if(F(e.data))return e.data;Array.isArray(e)&&(e={data:e});let r=e.type;return r||(r=R(t)?Uint16Array:Float32Array),new r(e.data)}function U(e,t){const r={};return Object.keys(t).forEach((function(n){if(!R(n)){const i=t[n],a=i.attrib||i.name||i.attribName||T.attribPrefix+n;if(i.value){if(!Array.isArray(i.value)&&!F(i.value))throw new Error("array.value is not array or typedarray");r[a]={value:i.value}}else{let t,u,s,l;if(i.buffer&&i.buffer instanceof WebGLBuffer)t=i.buffer,l=i.numComponents||i.size,u=i.type,s=i.normalize;else if("number"==typeof i||"number"==typeof i.data){const r=i.data||i,a=i.type||Float32Array,c=r*a.BYTES_PER_ELEMENT;u=g(a),s=void 0!==i.normalize?i.normalize:(o=a)===Int8Array||o===Uint8Array,l=i.numComponents||i.size||B(n,r),t=e.createBuffer(),e.bindBuffer(34962,t),e.bufferData(34962,c,i.drawType||35044)}else{const r=D(i,n);t=_(e,r,void 0,i.drawType),u=x(r),s=void 0!==i.normalize?i.normalize:function(e){return e instanceof Int8Array||e instanceof Uint8Array}(r),l=M(i,n)}r[a]={buffer:t,numComponents:l,type:u,normalize:s,stride:i.stride||0,offset:i.offset||0,divisor:void 0===i.divisor?void 0:i.divisor,drawType:i.drawType}}}var o})),e.bindBuffer(34962,null),r}const z=["position","positions","a_position"];function L(e,t,r){const n=U(e,t),o=Object.assign({},r||{});o.attribs=Object.assign({},r?r.attribs:{},n);const i=t.indices;if(i){const t=D(i,"indices");o.indices=_(e,t,34963),o.numElements=t.length,o.elementType=x(t)}else o.numElements||(o.numElements=function(e,t){let r,n;for(n=0;n<z.length&&(r=z[n],!(r in t))&&(r=T.attribPrefix+r,!(r in t));++n);n===z.length&&(r=Object.keys(t)[0]);const o=t[r];if(!o.buffer)return 1;e.bindBuffer(34962,o.buffer);const i=e.getBufferParameter(34962,34660);var a;e.bindBuffer(34962,null);const u=i/(5120===(a=o.type)||5121===a?1:5122===a||5123===a?2:5124===a||5125===a||5126===a?4:0),s=o.numComponents||o.size,l=u/s;if(l%1!=0)throw new Error(`numComponents ${s} not correct for length ${length}`);return l}(e,o.attribs));return o}function O(e,t,r){const n="indices"===r?34963:34962;return _(e,D(t,r),n)}function k(e,t){const r={};return Object.keys(t).forEach((function(n){r[n]=O(e,t[n],n)})),t.indices?(r.numElements=t.indices.length,r.elementType=x(D(t.indices))):r.numElements=function(e){let t,r;for(r=0;r<z.length&&(t=z[r],!(t in e));++r);r===z.length&&(t=Object.keys(e)[0]);const n=e[t],o=S(n).length;if(void 0===o)return 1;const i=M(n,t),a=o/i;if(o%i>0)throw new Error(`numComponents ${i} not correct for length ${o}`);return a}(t),r}function N(e,t){let r=0;return e.push=function(){for(let t=0;t<arguments.length;++t){const n=arguments[t];if(n instanceof Array||F(n))for(let t=0;t<n.length;++t)e[r++]=n[t];else e[r++]=n}},e.reset=function(e){r=e||0},e.numComponents=t,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function V(e,t,r){return N(new(r||Float32Array)(e*t),e)}function j(e,t,r){const n=e.length,o=new Float32Array(3);for(let i=0;i<n;i+=3)r(t,[e[i],e[i+1],e[i+2]],o),e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2]}function H(e,t,r){r=r||l();const n=t[0],o=t[1],i=t[2];return r[0]=n*e[0]+o*e[1]+i*e[2],r[1]=n*e[4]+o*e[5]+i*e[6],r[2]=n*e[8]+o*e[9]+i*e[10],r}function W(e,t){return j(e,t,b),e}function G(e,t){return j(e,p(t),H),e}function $(e,t){return j(e,t,y),e}function Y(e,t){return Object.keys(e).forEach((function(r){const n=e[r];r.indexOf("pos")>=0?$(n,t):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?W(n,t):r.indexOf("norm")>=0&&G(n,t)})),e}function X(e,t,r){return e=e||2,{position:{numComponents:2,data:[(t=t||0)+-1*(e*=.5),(r=r||0)+-1*e,t+1*e,r+-1*e,t+-1*e,r+1*e,t+1*e,r+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function K(e,t,r,n,o){e=e||1,t=t||1,r=r||1,n=n||1,o=o||d();const i=(r+1)*(n+1),a=V(3,i),u=V(3,i),s=V(2,i);for(let o=0;o<=n;o++)for(let i=0;i<=r;i++){const l=i/r,c=o/n;a.push(e*l-.5*e,0,t*c-.5*t),u.push(0,1,0),s.push(l,c)}const l=r+1,c=V(3,r*n*2,Uint16Array);for(let e=0;e<n;e++)for(let t=0;t<r;t++)c.push((e+0)*l+t,(e+1)*l+t,(e+0)*l+t+1),c.push((e+1)*l+t,(e+1)*l+t+1,(e+0)*l+t+1);return Y({position:a,normal:u,texcoord:s,indices:c},o)}function q(e,t,r,n,o,i,a){if(t<=0||r<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,i=i||0;const u=(o=o||Math.PI)-n,s=(a=a||2*Math.PI)-i,l=(t+1)*(r+1),c=V(3,l),f=V(3,l),m=V(2,l);for(let o=0;o<=r;o++)for(let a=0;a<=t;a++){const l=a/t,d=o/r,p=s*l+i,y=u*d+n,b=Math.sin(p),h=Math.cos(p),x=Math.sin(y),g=h*x,v=Math.cos(y),F=b*x;c.push(e*g,e*v,e*F),f.push(g,v,F),m.push(1-l,d)}const d=t+1,p=V(3,t*r*2,Uint16Array);for(let e=0;e<t;e++)for(let t=0;t<r;t++)p.push((t+0)*d+e,(t+0)*d+e+1,(t+1)*d+e),p.push((t+1)*d+e,(t+0)*d+e+1,(t+1)*d+e+1);return{position:c,normal:f,texcoord:m,indices:p}}const Z=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function J(e){const t=(e=e||1)/2,r=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],i=V(3,24),a=V(3,24),u=V(2,24),s=V(3,12,Uint16Array);for(let e=0;e<6;++e){const t=Z[e];for(let s=0;s<4;++s){const l=r[t[s]],c=n[e],f=o[s];i.push(l),a.push(c),u.push(f)}const l=4*e;s.push(l+0,l+1,l+2),s.push(l+0,l+2,l+3)}return{position:i,normal:a,texcoord:u,indices:s}}function Q(e,t,r,n,o,i,a){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(o<1)throw new Error("verticalSubdivisions must be 1 or greater");const u=void 0===i||i,s=void 0===a||a,l=(u?2:0)+(s?2:0),c=(n+1)*(o+1+l),f=V(3,c),m=V(3,c),d=V(2,c),p=V(3,n*(o+l/2)*2,Uint16Array),y=n+1,b=Math.atan2(e-t,r),h=Math.cos(b),x=Math.sin(b),g=o+(s?2:0);for(let i=u?-2:0;i<=g;++i){let a,u=i/o,s=r*u;i<0?(s=0,u=1,a=e):i>o?(s=r,u=1,a=t):a=e+i/o*(t-e),-2!==i&&i!==o+2||(a=0,u=0),s-=r/2;for(let e=0;e<y;++e){const t=Math.sin(e*Math.PI*2/n),r=Math.cos(e*Math.PI*2/n);f.push(t*a,s,r*a),i<0?m.push(0,-1,0):i>o?m.push(0,1,0):0===a?m.push(0,0,0):m.push(t*h,x,r*h),d.push(e/n,1-u)}}for(let e=0;e<o+l;++e)if(!(1===e&&u||e===o+l-2&&s))for(let t=0;t<n;++t)p.push(y*(e+0)+0+t,y*(e+0)+1+t,y*(e+1)+1+t),p.push(y*(e+0)+0+t,y*(e+1)+1+t,y*(e+1)+0+t);return{position:f,normal:m,texcoord:d,indices:p}}function ee(e,t){t=t||[];const r=[];for(let n=0;n<e.length;n+=4){const o=e[n],i=e.slice(n+1,n+4);i.push.apply(i,t);for(let e=0;e<o;++e)r.push.apply(r,i)}return r}function te(){const e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=ee([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=ee([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=e.length/3,o={position:V(3,n),texcoord:V(2,n),normal:V(3,n),color:V(4,n,Uint8Array),indices:V(3,n/3,Uint16Array)};o.position.push(e),o.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),o.normal.push(t),o.color.push(r);for(let e=0;e<n;++e)o.indices.push(e);return o}function re(e,t,r,n,o,i,a){if(o<=0)throw new Error("subdivisionDown must be > 0");const u=(a=a||1)-(i=i||0),s=2*(o+1)*4,l=V(3,s),m=V(3,s),d=V(2,s);function p(e,t,r){return e+(t-e)*r}function y(t,r,a,s,y,b){for(let h=0;h<=o;h++){const x=r/1,g=h/o,v=2*(x-.5),F=(i+g*u)*Math.PI,E=Math.sin(F),A=Math.cos(F),w=p(e,t,E),T=v*n,P=A*e,_=E*w;l.push(T,P,_);const R=c(f([0,E,A],a),s);m.push(R),d.push(x*y+b,g)}}for(let e=0;e<2;e++){const n=2*(e/1-.5);y(t,e,[1,1,1],[0,0,0],1,0),y(t,e,[0,0,0],[n,0,0],0,0),y(r,e,[1,1,1],[0,0,0],1,0),y(r,e,[0,0,0],[n,0,0],0,1)}const b=V(3,2*o*4,Uint16Array);function h(e,t){for(let r=0;r<o;++r)b.push(e+r+0,e+r+1,t+r+0),b.push(e+r+1,t+r+1,t+r+0)}const x=o+1;return h(0*x,4*x),h(5*x,7*x),h(6*x,2*x),h(3*x,1*x),{position:l,normal:m,texcoord:d,indices:b}}function ne(e,t,r,n,o,i){return Q(e,e,t,r,n,o,i)}function oe(e,t,r,n,o,i){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");o=o||0;const a=(i=i||2*Math.PI)-o,u=r+1,s=n+1,l=u*s,c=V(3,l),f=V(3,l),m=V(2,l),d=V(3,r*n*2,Uint16Array);for(let i=0;i<s;++i){const s=i/n,l=s*Math.PI*2,d=Math.sin(l),p=e+d*t,y=Math.cos(l),b=y*t;for(let e=0;e<u;++e){const t=e/r,n=o+t*a,i=Math.sin(n),u=Math.cos(n),l=i*p,h=u*p,x=i*d,g=u*d;c.push(l,b,h),f.push(x,y,g),m.push(t,1-s)}}for(let e=0;e<n;++e)for(let t=0;t<r;++t){const r=1+t,n=1+e;d.push(u*e+t,u*n+t,u*e+r),d.push(u*n+t,u*n+r,u*e+r)}return{position:c,normal:f,texcoord:m,indices:d}}function ie(e,t,r,n,o){if(t<3)throw new Error("divisions must be at least 3");o=o||1,n=n||0;const i=(t+1)*((r=r||1)+1),a=V(3,i),u=V(3,i),s=V(2,i),l=V(3,r*t*2,Uint16Array);let c=0;const f=e-n,m=t+1;for(let e=0;e<=r;++e){const i=n+f*Math.pow(e/r,o);for(let n=0;n<=t;++n){const o=2*Math.PI*n/t,f=i*Math.cos(o),d=i*Math.sin(o);if(a.push(f,0,d),u.push(0,1,0),s.push(1-n/t,e/r),e>0&&n!==t){const e=c+(n+1),t=c+n,r=c+n-m,o=c+(n+1)-m;l.push(e,t,r),l.push(e,r,o)}}c+=t+1}return{position:a,normal:u,texcoord:s,indices:l}}function ae(e){return function(t){const r=e.apply(this,Array.prototype.slice.call(arguments,1));return k(t,r)}}function ue(e){return function(t){const r=e.apply(null,Array.prototype.slice.call(arguments,1));return L(t,r)}}ue(te),ae(te),ue(J),ae(J),ue(K),ae(K),ue(q),ae(q),ue(Q),ae(Q),ue(X),ae(X),ue(re),ae(re),ue(ne),ae(ne),ue(oe),ae(oe),ue(ie),ae(ie);function se(e){return!!e.texStorage2D}const le=function(){const e={},t={};return function(r,n){return function(r){const n=r.constructor.name;if(!e[n]){for(const e in r)if("number"==typeof r[e]){const n=t[r[e]];t[r[e]]=n?`${n} | ${e}`:e}e[n]=!0}}(r),t[n]||("number"==typeof n?`0x${n.toString(16)}`:n)}}();const ce={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},fe=F,me=function(){let e;return function(){return e=e||("undefined"!=typeof document&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),de={};{const e=de;e[6406]={numColorComponents:1},e[6409]={numColorComponents:1},e[6410]={numColorComponents:2},e[6407]={numColorComponents:3},e[6408]={numColorComponents:4},e[6403]={numColorComponents:1},e[36244]={numColorComponents:1},e[33319]={numColorComponents:2},e[33320]={numColorComponents:2},e[6407]={numColorComponents:3},e[36248]={numColorComponents:3},e[6408]={numColorComponents:4},e[36249]={numColorComponents:4},e[6402]={numColorComponents:1},e[34041]={numColorComponents:2}}let pe;function ye(e){if(!pe){const e={6406:{textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},6409:{textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},6410:{textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},6407:{textureFormat:6407,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},6408:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},6402:{textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5125,5123]},33321:{textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[5121]},36756:{textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[5120]},33325:{textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},33326:{textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[5126]},33330:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[5121]},33329:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[5120]},33332:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5123]},33331:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5122]},33334:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5125]},33333:{textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5124]},33323:{textureFormat:33319,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[5121]},36757:{textureFormat:33319,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[5120]},33327:{textureFormat:33319,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},33328:{textureFormat:33319,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[5126]},33336:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5121]},33335:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5120]},33338:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5123]},33337:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5122]},33340:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5125]},33339:{textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5124]},32849:{textureFormat:6407,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[5121]},35905:{textureFormat:6407,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[5121]},36194:{textureFormat:6407,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},36758:{textureFormat:6407,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[5120]},35898:{textureFormat:6407,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},35901:{textureFormat:6407,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},34843:{textureFormat:6407,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},34837:{textureFormat:6407,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5126]},36221:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[5121]},36239:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[5120]},36215:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5123]},36233:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5122]},36209:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5125]},36227:{textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5124]},32856:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[5121]},35907:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[5121]},36759:{textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[5120]},32855:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},32854:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},32857:{textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[33640]},34842:{textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},34836:{textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[5126]},36220:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5121]},36238:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5120]},36975:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[33640]},36214:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5123]},36232:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5122]},36226:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5124]},36208:{textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5125]},33189:{textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},33190:{textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5125]},36012:{textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5126]},35056:{textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[34042]},36013:{textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[36269]}};Object.keys(e).forEach((function(t){const r=e[t];r.bytesPerElementMap={},r.bytesPerElement.forEach((function(e,t){const n=r.type[t];r.bytesPerElementMap[n]=e}))})),pe=e}return pe[e]}function be(e,t){const r=ye(e);if(!r)throw"unknown internal format";const n=r.bytesPerElementMap[t];if(void 0===n)throw"unknown internal format";return n}function he(e){const t=ye(e);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function xe(e){return 0==(e&e-1)}function ge(e,t,r,n){if(!se(e))return xe(t)&&xe(r);const o=ye(n);if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}function ve(e){const t=ye(e);if(!t)throw"unknown internal format";return t.textureFilterable}function Fe(e,t,r){return fe(t)?x(t):r||5121}function Ee(e,t,r,n,o){if(o%1!=0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=o/n)%1)throw"can't guess dimensions"}else if((n=o/r)%1)throw"can't guess dimensions"}else{const e=Math.sqrt(o/(34067===t?6:1));e%1==0?(r=e,n=e):(r=o,n=1)}return{width:r,height:n}}function Ae(e,t){void 0!==t.colorspaceConversion&&e.pixelStorei(37443,t.colorspaceConversion),void 0!==t.premultiplyAlpha&&e.pixelStorei(37441,t.premultiplyAlpha),void 0!==t.flipY&&e.pixelStorei(37440,t.flipY)}function we(e){e.pixelStorei(3317,4),se(e)&&(e.pixelStorei(3314,0),e.pixelStorei(32878,0),e.pixelStorei(3316,0),e.pixelStorei(3315,0),e.pixelStorei(32877,0))}function Te(e,t,r,n){var o;n.minMag&&(r.call(e,t,10241,n.minMag),r.call(e,t,10240,n.minMag)),n.min&&r.call(e,t,10241,n.min),n.mag&&r.call(e,t,10240,n.mag),n.wrap&&(r.call(e,t,10242,n.wrap),r.call(e,t,10243,n.wrap),(32879===t||(o=t,"undefined"!=typeof WebGLSampler&&o instanceof WebGLSampler))&&r.call(e,t,32882,n.wrap)),n.wrapR&&r.call(e,t,32882,n.wrapR),n.wrapS&&r.call(e,t,10242,n.wrapS),n.wrapT&&r.call(e,t,10243,n.wrapT),n.minLod&&r.call(e,t,33082,n.minLod),n.maxLod&&r.call(e,t,33083,n.maxLod),n.baseLevel&&r.call(e,t,33084,n.baseLevel),n.maxLevel&&r.call(e,t,33085,n.maxLevel)}function Pe(e,t,r){const n=r.target||3553;e.bindTexture(n,t),Te(e,n,e.texParameteri,r)}function _e(e,t,r,n,o,i){i=i||6408;const a=(r=r||ce.textureOptions).target||3553;if(n=n||r.width,o=o||r.height,e.bindTexture(a,t),ge(e,n,o,i))e.generateMipmap(a);else{const t=ve(i)?9729:9728;e.texParameteri(a,10241,t),e.texParameteri(a,10240,t),e.texParameteri(a,10242,33071),e.texParameteri(a,10243,33071)}}function Re(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function Se(e,t){return(t=t||{}).cubeFaceOrder||[34069,34070,34071,34072,34073,34074]}function Ie(e,t){const r=Se(0,t).map((function(e,t){return{face:e,ndx:t}}));return r.sort((function(e,t){return e.face-t.face})),r}function Ce(e,t,r,n){const o=(n=n||ce.textureOptions).target||3553,i=n.level||0;let a=r.width,u=r.height;const s=n.internalFormat||n.format||6408,l=he(s),c=n.format||l.format,f=n.type||l.type;if(Ae(e,n),e.bindTexture(o,t),34067===o){const l=r.width,m=r.height;let d,p;if(l/6===m)d=m,p=[0,0,1,0,2,0,3,0,4,0,5,0];else if(m/6===l)d=l,p=[0,0,0,1,0,2,0,3,0,4,0,5];else if(l/3==m/2)d=l/3,p=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(l/2!=m/3)throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);d=l/2,p=[0,0,1,0,0,1,1,1,0,2,1,2]}const y=me();y?(y.canvas.width=d,y.canvas.height=d,a=d,u=d,Ie(0,n).forEach((function(t){const n=p[2*t.ndx+0]*d,o=p[2*t.ndx+1]*d;y.drawImage(r,n,o,d,d,0,0,d,d),e.texImage2D(t.face,i,s,c,f,y.canvas)})),y.canvas.width=1,y.canvas.height=1):"undefined"!=typeof createImageBitmap&&(a=d,u=d,Ie(0,n).forEach((function(l){const m=p[2*l.ndx+0]*d,y=p[2*l.ndx+1]*d;e.texImage2D(l.face,i,s,d,d,0,c,f,null),createImageBitmap(r,m,y,d,d,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((function(r){Ae(e,n),e.bindTexture(o,t),e.texImage2D(l.face,i,s,c,f,r),Re(n)&&_e(e,t,n,a,u,s)}))})))}else if(32879===o||35866===o){const t=Math.min(r.width,r.height),n=Math.max(r.width,r.height),a=n/t;if(a%1!=0)throw"can not compute 3D dimensions of element";const u=r.width===n?1:0,l=r.height===n?1:0;e.pixelStorei(3317,1),e.pixelStorei(3314,r.width),e.pixelStorei(32878,0),e.pixelStorei(32877,0),e.texImage3D(o,i,s,t,t,t,0,c,f,null);for(let n=0;n<a;++n){const a=n*t*u,s=n*t*l;e.pixelStorei(3316,a),e.pixelStorei(3315,s),e.texSubImage3D(o,i,0,0,n,t,t,1,c,f,r)}we(e)}else e.texImage2D(o,i,s,c,f,r);Re(n)&&_e(e,t,n,a,u,s),Pe(e,t,n)}function Be(){}function Me(e,t){return void 0!==t||function(e){if("undefined"!=typeof document){const t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}{const t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}(e)?t:"anonymous"}function De(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function Ue(e,t,r){return De(e)?(setTimeout((function(){r(null,e)})),e):function(e,t,r){let n;if(r=r||Be,t=void 0!==t?t:ce.crossOrigin,t=Me(e,t),"undefined"!=typeof Image){n=new Image,void 0!==t&&(n.crossOrigin=t);const o=function(){n.removeEventListener("error",i),n.removeEventListener("load",a),n=null},i=function(){const t="couldn't load image: "+e;E(t),r(t,n),o()},a=function(){r(null,n),o()};return n.addEventListener("error",i),n.addEventListener("load",a),n.src=e,n}if("undefined"!=typeof ImageBitmap){let o,i;const a=function(){r(o,i)},u={};t&&(u.mode="cors"),fetch(e,u).then((function(e){if(!e.ok)throw e;return e.blob()})).then((function(e){return createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(e){i=e,setTimeout(a)})).catch((function(e){o=e,setTimeout(a)})),n=null}return n}(e,t,r)}function ze(e,t,r){const n=(r=r||ce.textureOptions).target||3553;if(e.bindTexture(n,t),!1===r.color)return;const o=function(e){return e=e||ce.textureColor,fe(e)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(r.color);if(34067===n)for(let t=0;t<6;++t)e.texImage2D(34069+t,0,6408,1,1,0,6408,5121,o);else 32879===n||35866===n?e.texImage3D(n,0,6408,1,1,1,0,6408,5121,o):e.texImage2D(n,0,6408,1,1,0,6408,5121,o)}function Le(e,t,r,n){n=n||Be,r=r||ce.textureOptions,ze(e,t,r);return Ue((r=Object.assign({},r)).src,r.crossOrigin,(function(o,i){o?n(o,t,i):(Ce(e,t,i,r),n(null,t,i))}))}function Oe(e,t,r,n){n=n||Be;const o=r.src;if(6!==o.length)throw"there must be 6 urls for a cubemap";const i=r.level||0,a=r.internalFormat||r.format||6408,u=he(a),s=r.format||u.format,l=r.type||5121,c=r.target||3553;if(34067!==c)throw"target must be TEXTURE_CUBE_MAP";ze(e,t,r),r=Object.assign({},r);let f=6;const m=[],d=Se(0,r);let p;p=o.map((function(o,u){return Ue(o,r.crossOrigin,(y=d[u],function(o,u){--f,o?m.push(o):u.width!==u.height?m.push("cubemap face img is not a square: "+u.src):(Ae(e,r),e.bindTexture(c,t),5===f?Se().forEach((function(t){e.texImage2D(t,i,a,s,l,u)})):e.texImage2D(y,i,a,s,l,u),Re(r)&&e.generateMipmap(c)),0===f&&n(m.length?m:void 0,t,p)}));var y}))}function ke(e,t,r,n){n=n||Be;const o=r.src,i=r.internalFormat||r.format||6408,a=he(i),u=r.format||a.format,s=r.type||5121,l=r.target||35866;if(32879!==l&&35866!==l)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";ze(e,t,r),r=Object.assign({},r);let c=o.length;const f=[];let m;const d=r.level||0;let p=r.width,y=r.height;const b=o.length;let h=!0;m=o.map((function(o,a){return Ue(o,r.crossOrigin,(x=a,function(o,a){if(--c,o)f.push(o);else{if(Ae(e,r),e.bindTexture(l,t),h){h=!1,p=r.width||a.width,y=r.height||a.height,e.texImage3D(l,d,i,p,y,b,0,u,s,null);for(let t=0;t<b;++t)e.texSubImage3D(l,d,0,0,t,p,y,1,u,s,a)}else{let t,r=a;a.width===p&&a.height===y||(t=me(),r=t.canvas,t.canvas.width=p,t.canvas.height=y,t.drawImage(a,0,0,p,y)),e.texSubImage3D(l,d,0,0,x,p,y,1,u,s,r),t&&r===t.canvas&&(t.canvas.width=0,t.canvas.height=0)}Re(r)&&e.generateMipmap(l)}0===c&&n(f.length?f:void 0,t,m)}));var x}))}function Ne(e,t,r,n){const o=(n=n||ce.textureOptions).target||3553;e.bindTexture(o,t);let i=n.width,a=n.height,u=n.depth;const s=n.level||0,l=n.internalFormat||n.format||6408,c=he(l),f=n.format||c.format,m=n.type||Fe(0,r,c.type);if(fe(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{const e=v(m);r=new e(r)}const d=be(l,m),p=r.byteLength/d;if(p%1)throw"length wrong size for format: "+le(e,f);let y;if(32879===o||35866===o)if(i||a||u)!i||a&&u?!a||i&&u?(y=Ee(0,o,i,a,p/u),i=y.width,a=y.height):(y=Ee(0,o,i,u,p/a),i=y.width,u=y.height):(y=Ee(0,o,a,u,p/i),a=y.width,u=y.height);else{const e=Math.cbrt(p);if(e%1!=0)throw"can't guess cube size of array of numElements: "+p;i=e,a=e,u=e}else y=Ee(0,o,i,a,p),i=y.width,a=y.height;if(we(e),e.pixelStorei(3317,n.unpackAlignment||1),Ae(e,n),34067===o){const t=p/6*(d/r.BYTES_PER_ELEMENT);Ie(0,n).forEach((n=>{const o=t*n.ndx,u=r.subarray(o,o+t);e.texImage2D(n.face,s,l,i,a,0,f,m,u)}))}else 32879===o||35866===o?e.texImage3D(o,s,l,i,a,u,0,f,m,r):e.texImage2D(o,s,l,i,a,0,f,m,r);return{width:i,height:a,depth:u,type:m}}function Ve(e,t,r){const n=r.target||3553;e.bindTexture(n,t);const o=r.level||0,i=r.internalFormat||r.format||6408,a=he(i),u=r.format||a.format,s=r.type||a.type;if(Ae(e,r),34067===n)for(let t=0;t<6;++t)e.texImage2D(34069+t,o,i,r.width,r.height,0,u,s,null);else 32879===n||35866===n?e.texImage3D(n,o,i,r.width,r.height,r.depth,0,u,s,null):e.texImage2D(n,o,i,r.width,r.height,0,u,s,null)}function je(e,t,r){r=r||Be,t=t||ce.textureOptions;const n=e.createTexture(),o=t.target||3553;let i=t.width||1,a=t.height||1;const u=t.internalFormat||6408;e.bindTexture(o,n),34067===o&&(e.texParameteri(o,10242,33071),e.texParameteri(o,10243,33071));let s=t.src;if(s)if("function"==typeof s&&(s=s(e,t)),"string"==typeof s)Le(e,n,t,r);else if(fe(s)||Array.isArray(s)&&("number"==typeof s[0]||Array.isArray(s[0])||fe(s[0]))){const r=Ne(e,n,s,t);i=r.width,a=r.height}else Array.isArray(s)&&("string"==typeof s[0]||De(s[0]))?34067===o?Oe(e,n,t,r):ke(e,n,t,r):(Ce(e,n,s,t),i=s.width,a=s.height);else Ve(e,n,t);return Re(t)&&_e(e,n,t,i,a,u),Pe(e,n,t),n}const He=E;function We(e){return"undefined"!=typeof document&&document.getElementById?document.getElementById(e):null}const Ge={};function $e(e,t){return Ge[t].bindPoint}function Ye(e,t){return function(r){e.uniform1i(t,r)}}function Xe(e,t){return function(r){e.uniform1iv(t,r)}}function Ke(e,t){return function(r){e.uniform2iv(t,r)}}function qe(e,t){return function(r){e.uniform3iv(t,r)}}function Ze(e,t){return function(r){e.uniform4iv(t,r)}}function Je(e,t,r,n){const o=$e(0,t);return se(e)?function(t){let i,a;w(0,t)?(i=t,a=null):(i=t.texture,a=t.sampler),e.uniform1i(n,r),e.activeTexture(33984+r),e.bindTexture(o,i),e.bindSampler(r,a)}:function(t){e.uniform1i(n,r),e.activeTexture(33984+r),e.bindTexture(o,t)}}function Qe(e,t,r,n,o){const i=$e(0,t),a=new Int32Array(o);for(let e=0;e<o;++e)a[e]=r+e;return se(e)?function(t){e.uniform1iv(n,a),t.forEach((function(t,n){let o,u;e.activeTexture(33984+a[n]),w(0,t)?(o=t,u=null):(o=t.texture,u=t.sampler),e.bindSampler(r,u),e.bindTexture(i,o)}))}:function(t){e.uniform1iv(n,a),t.forEach((function(t,r){e.activeTexture(33984+a[r]),e.bindTexture(i,t)}))}}function et(e,t){return function(r){if(r.value)switch(e.disableVertexAttribArray(t),r.value.length){case 4:e.vertexAttrib4fv(t,r.value);break;case 3:e.vertexAttrib3fv(t,r.value);break;case 2:e.vertexAttrib2fv(t,r.value);break;case 1:e.vertexAttrib1fv(t,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(34962,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.numComponents||r.size,r.type||5126,r.normalize||!1,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function tt(e,t){return function(r){if(r.value){if(e.disableVertexAttribArray(t),4!==r.value.length)throw new Error("The length of an integer constant value must be 4!");e.vertexAttrib4iv(t,r.value)}else e.bindBuffer(34962,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||5124,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function rt(e,t){return function(r){if(r.value){if(e.disableVertexAttribArray(t),4!==r.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");e.vertexAttrib4uiv(t,r.value)}else e.bindBuffer(34962,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||5125,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function nt(e,t,r){const n=r.size,o=r.count;return function(r){e.bindBuffer(34962,r.buffer);const i=r.size||r.numComponents||n,a=i/o,u=r.type||5126,s=Ge[u].size*i,l=r.normalize||!1,c=r.offset||0,f=s/o;for(let n=0;n<o;++n)e.enableVertexAttribArray(t+n),e.vertexAttribPointer(t+n,a,u,l,s,c+f*n),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+n,r.divisor||0)}}Ge[5126]={Type:Float32Array,size:4,setter:function(e,t){return function(r){e.uniform1f(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1fv(t,r)}}},Ge[35664]={Type:Float32Array,size:8,setter:function(e,t){return function(r){e.uniform2fv(t,r)}},cols:2},Ge[35665]={Type:Float32Array,size:12,setter:function(e,t){return function(r){e.uniform3fv(t,r)}},cols:3},Ge[35666]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniform4fv(t,r)}},cols:4},Ge[5124]={Type:Int32Array,size:4,setter:Ye,arraySetter:Xe},Ge[35667]={Type:Int32Array,size:8,setter:Ke,cols:2},Ge[35668]={Type:Int32Array,size:12,setter:qe,cols:3},Ge[35669]={Type:Int32Array,size:16,setter:Ze,cols:4},Ge[5125]={Type:Uint32Array,size:4,setter:function(e,t){return function(r){e.uniform1ui(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1uiv(t,r)}}},Ge[36294]={Type:Uint32Array,size:8,setter:function(e,t){return function(r){e.uniform2uiv(t,r)}},cols:2},Ge[36295]={Type:Uint32Array,size:12,setter:function(e,t){return function(r){e.uniform3uiv(t,r)}},cols:3},Ge[36296]={Type:Uint32Array,size:16,setter:function(e,t){return function(r){e.uniform4uiv(t,r)}},cols:4},Ge[35670]={Type:Uint32Array,size:4,setter:Ye,arraySetter:Xe},Ge[35671]={Type:Uint32Array,size:8,setter:Ke,cols:2},Ge[35672]={Type:Uint32Array,size:12,setter:qe,cols:3},Ge[35673]={Type:Uint32Array,size:16,setter:Ze,cols:4},Ge[35674]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}},rows:2,cols:2},Ge[35675]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}},rows:3,cols:3},Ge[35676]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}},rows:4,cols:4},Ge[35685]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}},rows:2,cols:3},Ge[35686]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}},rows:2,cols:4},Ge[35687]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}},rows:3,cols:2},Ge[35688]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}},rows:3,cols:4},Ge[35689]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}},rows:4,cols:2},Ge[35690]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}},rows:4,cols:3},Ge[35678]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:3553},Ge[35680]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:34067},Ge[35679]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:32879},Ge[35682]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:3553},Ge[36289]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:35866},Ge[36292]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:35866},Ge[36293]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:34067},Ge[36298]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:3553},Ge[36299]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:32879},Ge[36300]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:34067},Ge[36303]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:35866},Ge[36306]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:3553},Ge[36307]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:32879},Ge[36308]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:34067},Ge[36311]={Type:null,size:0,setter:Je,arraySetter:Qe,bindPoint:35866};const ot={};ot[5126]={size:4,setter:et},ot[35664]={size:8,setter:et},ot[35665]={size:12,setter:et},ot[35666]={size:16,setter:et},ot[5124]={size:4,setter:tt},ot[35667]={size:8,setter:tt},ot[35668]={size:12,setter:tt},ot[35669]={size:16,setter:tt},ot[5125]={size:4,setter:rt},ot[36294]={size:8,setter:rt},ot[36295]={size:12,setter:rt},ot[36296]={size:16,setter:rt},ot[35670]={size:4,setter:tt},ot[35671]={size:8,setter:tt},ot[35672]={size:12,setter:tt},ot[35673]={size:16,setter:tt},ot[35674]={size:4,setter:nt,count:2},ot[35675]={size:9,setter:nt,count:3},ot[35676]={size:16,setter:nt,count:4};const it=/ERROR:\s*\d+:(\d+)/gi;const at=/^[ \t]*\n/;function ut(e){let t=0;return at.test(e)&&(t=1,e=e.replace(at,"")),{lineOffset:t,shaderSource:e}}function st(e,t){return e.errorCallback(t),e.callback&&setTimeout((()=>{e.callback(`${t}\n${e.errors.join("\n")}`)})),null}function lt(e,t,r,n){const o=e.createShader(r);return e.shaderSource(o,ut(t).shaderSource),e.compileShader(o),n.callback||function(e,t,r,n){n=n||He;const o=e.getShaderParameter(r,35713);if(!o){const o=e.getShaderInfoLog(r),{lineOffset:i,shaderSource:a}=ut(e.getShaderSource(r));n(`${function(e,t="",r=0){const n=[...t.matchAll(it)],o=new Map(n.map(((e,r)=>{const o=parseInt(e[1]),i=n[r+1],a=i?i.index:t.length;return[o-1,t.substring(e.index,a)]})));return e.split("\n").map(((e,t)=>{const n=o.get(t);return`${t+1+r}: ${e}${n?`\n\n^^^ ${n}`:""}`})).join("\n")}(a,o,i)}\nError compiling ${le(e,t)}: ${o}`)}return o}(e,r,o,n.errorCallback)?o:(e.deleteShader(o),null)}function ct(e,t,r){let n,o,i;if("function"==typeof t&&(r=t,t=void 0),"function"==typeof e)r=e,e=void 0;else if(e&&!Array.isArray(e)){if(e.errorCallback&&e.errors)return e;const t=e;r=t.errorCallback,e=t.attribLocations,n=t.transformFeedbackVaryings,o=t.transformFeedbackMode,i=t.callback}const a=r||He,u=[],s={errorCallback(e,...t){u.push(e),a(e,...t)},transformFeedbackVaryings:n,transformFeedbackMode:o,callback:i,errors:u};if(e){let r={};Array.isArray(e)?e.forEach((function(e,n){r[e]=t?t[n]:n})):r=e,s.attribLocations=r}return s}const ft=["VERTEX_SHADER","FRAGMENT_SHADER"];function mt(e,t){return t.indexOf("frag")>=0?35632:t.indexOf("vert")>=0?35633:void 0}function dt(e,t){t.forEach((function(t){e.deleteShader(t)}))}const pt=(e=0)=>new Promise((t=>setTimeout(t,e)));function yt(e,t,r,n,o){const i=ct(r,n,o),a=[],u=[];for(let r=0;r<t.length;++r){let n=t[r];if("string"==typeof n){const t=We(n),o=t?t.text:n;let a=e[ft[r]];t&&t.type&&(a=mt(0,t.type)||a),n=lt(e,o,a,i),u.push(n)}s=n,"undefined"!=typeof WebGLShader&&s instanceof WebGLShader&&a.push(n)}var s;if(a.length!==t.length)return dt(e,u),st(i,"not enough shaders for program");const l=e.createProgram();a.forEach((function(t){e.attachShader(l,t)})),i.attribLocations&&Object.keys(i.attribLocations).forEach((function(t){e.bindAttribLocation(l,i.attribLocations[t],t)}));let c=i.transformFeedbackVaryings;return c&&(c.attribs&&(c=c.attribs),Array.isArray(c)||(c=Object.keys(c)),e.transformFeedbackVaryings(l,c,i.transformFeedbackMode||35981)),e.linkProgram(l),i.callback?(async function(e,t,r){const n=e.getExtension("KHR_parallel_shader_compile"),o=n?(e,t)=>e.getProgramParameter(t,n.COMPLETION_STATUS_KHR):()=>!0;let i=0;do{await pt(i),i=1e3/60}while(!o(e,t));const a=bt(e,t,r.errorCallback),u=a?void 0:r.errors.join("\n");if(!a){(r.errorCallback||He)(u),e.deleteProgram(t),t=null}r.callback(u,t)}(e,l,i),null):bt(e,l,i.errorCallback)?l:(e.deleteProgram(l),dt(e,u),null)}function bt(e,t,r){r=r||He;const n=e.getProgramParameter(t,35714);if(!n){r(`Error in program linking: ${e.getProgramInfoLog(t)}`)}return n}function ht(e,t,r,n,o){const i=ct(r,n,o),a=[];for(let r=0;r<t.length;++r){const n=lt(e,t[r],e[ft[r]],i);if(!i.callback&&!n)return null;a.push(n)}return yt(e,a,i)}function xt(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const gt=/(\.|\[|]|\w+)/g;function vt(e,t,r,n){const o=e.split(gt).filter((e=>""!==e));let i=0,a="";for(;;){const e=o[i++];a+=e;const s=(u=e[0])>="0"&&u<="9",l=s?parseInt(e):e;s&&(a+=o[i++]);if(i===o.length){r[l]=t;break}{const e=o[i++],t="["===e,u=r[l]||(t?[]:{});r[l]=u,r=u,n[a]=n[a]||function(e){return function(t){wt(e,t)}}(u),a+=e}}var u}function Ft(e,t){let r=0;function n(t,n,o){const i=n.name.endsWith("[0]"),a=n.type,u=Ge[a];if(!u)throw new Error(`unknown type: 0x${a.toString(16)}`);let s;if(u.bindPoint){const t=r;r+=n.size,s=i?u.arraySetter(e,a,t,o,n.size):u.setter(e,a,t,o,n.size)}else s=u.arraySetter&&i?u.arraySetter(e,o):u.setter(e,o);return s.location=o,s}const o={},i={},a=e.getProgramParameter(t,35718);for(let r=0;r<a;++r){const a=e.getActiveUniform(t,r);if(xt(a))continue;let u=a.name;u.endsWith("[0]")&&(u=u.substr(0,u.length-3));const s=e.getUniformLocation(t,a.name);if(s){const e=n(0,a,s);o[u]=e,vt(u,e,i,o)}}return o}function Et(e,t){const r={},n=e.getProgramParameter(t,35971);for(let o=0;o<n;++o){const n=e.getTransformFeedbackVarying(t,o);r[n.name]={index:o,type:n.type,size:n.size}}return r}function At(e,t){const r=e.getProgramParameter(t,35718),n=[],o=[];for(let i=0;i<r;++i){o.push(i),n.push({});const r=e.getActiveUniform(t,i);n[i].name=r.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(r){const i=r[0],a=r[1];e.getActiveUniforms(t,o,e[i]).forEach((function(e,t){n[t][a]=e}))}));const i={},a=e.getProgramParameter(t,35382);for(let r=0;r<a;++r){const n=e.getActiveUniformBlockName(t,r),o={index:e.getUniformBlockIndex(t,n),usedByVertexShader:e.getActiveUniformBlockParameter(t,r,35396),usedByFragmentShader:e.getActiveUniformBlockParameter(t,r,35398),size:e.getActiveUniformBlockParameter(t,r,35392),uniformIndices:e.getActiveUniformBlockParameter(t,r,35395)};o.used=o.usedByVertexShader||o.usedByFragmentShader,i[n]=o}return{blockSpecs:i,uniformData:n}}function wt(e,t){for(const r in t){const n=e[r];"function"==typeof n?n(t[r]):wt(e[r],t[r])}}function Tt(e,...t){const r=e.uniformSetters||e,n=t.length;for(let e=0;e<n;++e){const n=t[e];if(Array.isArray(n)){const e=n.length;for(let t=0;t<e;++t)Tt(r,n[t])}else for(const e in n){const t=r[e];t&&t(n[e])}}}function Pt(e,t){const r={},n=e.getProgramParameter(t,35721);for(let o=0;o<n;++o){const n=e.getActiveAttrib(t,o);if(xt(n))continue;const i=e.getAttribLocation(t,n.name),a=ot[n.type],u=a.setter(e,i,a);u.location=i,r[n.name]=u}return r}function _t(e,t){for(const r in t){const n=e[r];n&&n(t[r])}}function Rt(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(_t(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(34963,r.indices))}function St(e,t){const r={program:t,uniformSetters:Ft(e,t),attribSetters:Pt(e,t)};return se(e)&&(r.uniformBlockSpec=At(e,t),r.transformFeedbackInfo=Et(e,t)),r}const It=/\s|{|}|;/;function Ct(e,t,r,n,o){const i=ct(r,n,o),a=[];if(t=t.map((function(e){if(!It.test(e)){const t=We(e);if(t)e=t.text;else{const t=`no element with id: ${e}`;i.errorCallback(t),a.push(t)}}return e})),a.length)return st(i,"");const u=i.callback;u&&(i.callback=(t,r)=>{let n;t||(n=St(e,r)),u(t,n)});const s=ht(e,t,i);return s?St(e,s):null}function Bt(e,t,r,n,o,i){r=void 0===r?4:r;const a=t.indices,u=t.elementType,s=void 0===n?t.numElements:n;o=void 0===o?0:o,u||a?void 0!==i?e.drawElementsInstanced(r,s,void 0===u?5123:t.elementType,o,i):e.drawElements(r,s,void 0===u?5123:t.elementType,o):void 0!==i?e.drawArraysInstanced(r,o,s,i):e.drawArrays(r,o,s)}const Mt=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],Dt={};Dt[34041]=33306,Dt[6401]=36128,Dt[36168]=36128,Dt[6402]=36096,Dt[33189]=36096,Dt[33190]=36096,Dt[36012]=36096,Dt[35056]=33306,Dt[36013]=33306;const Ut={};Ut[32854]=!0,Ut[32855]=!0,Ut[36194]=!0,Ut[34041]=!0,Ut[33189]=!0,Ut[6401]=!0,Ut[36168]=!0;function zt(e,t,r,n){const o=36160,i=e.createFramebuffer();e.bindFramebuffer(o,i),r=r||e.drawingBufferWidth,n=n||e.drawingBufferHeight;const a=[],u={framebuffer:i,attachments:[],width:r,height:n};return(t=t||Mt).forEach((function(t,i){let s=t.attachment;const l=t.samples,c=t.format;let f=t.attachmentPoint||function(e,t){return Dt[e]||Dt[t]}(c,t.internalFormat);if(f||(f=36064+i),function(e){return e>=36064&&e<36096}(f)&&a.push(f),!s)if(void 0!==l||function(e){return Ut[e]}(c))s=e.createRenderbuffer(),e.bindRenderbuffer(36161,s),l>1?e.renderbufferStorageMultisample(36161,l,c,r,n):e.renderbufferStorage(36161,c,r,n);else{const o=Object.assign({},t);o.width=r,o.height=n,void 0===o.auto&&(o.auto=!1,o.min=o.min||o.minMag||9729,o.mag=o.mag||o.minMag||9729,o.wrapS=o.wrapS||o.wrap||33071,o.wrapT=o.wrapT||o.wrap||33071),s=je(e,o)}if(A(0,s))e.framebufferRenderbuffer(o,f,36161,s);else{if(!w(0,s))throw new Error("unknown attachment type");void 0!==t.layer?e.framebufferTextureLayer(o,f,s,t.level||0,t.layer):e.framebufferTexture2D(o,f,t.target||3553,s,t.level||0)}u.attachments.push(s)})),e.drawBuffers&&e.drawBuffers(a),u}function Lt(e,t,r){const n=e.createVertexArray();return e.bindVertexArray(n),t.length||(t=[t]),t.forEach((function(t){Rt(e,t,r)})),e.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:n}}function Ot(e,t){t=t||1,t=Math.max(0,t);const r=e.clientWidth*t|0,n=e.clientHeight*t|0;return(e.width!==r||e.height!==n)&&(e.width=r,e.height=n,!0)}const kt={population:131070,sensorDist:5+50*Math.random(),sensorAngle:Math.random()*(Math.PI/3)+.01,decay:.001+.1*Math.random(),showEnvironment:!1,imageToShow:0};function Nt(e){return t=>{const r=parseFloat(t.target.value);kt[e]=r,console.log(e,r)}}async function Vt(e){return new Promise(((t,r)=>{const n=new Image;n.src=e,n.addEventListener("load",(()=>t(n))),n.addEventListener("error",(e=>r(e)))}))}function jt(e,t){const r=[];for(let n=0;n<e*t;++n)r.push(Math.random());return new Uint8Array(r)}function Ht(e,r){const n=kt.population,o=Ct(e,[t("#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n/* Where the particle is. */\nlayout (location = 1) in vec2 i_Position;\nlayout (location = 2) in vec2 i_Velocity;\n\n/* Number of seconds (possibly fractional) that has passed since the last\n   update step. */\nuniform float u_TimeDelta;\nuniform vec2 u_Size;\nuniform sampler2D u_Random;\nuniform sampler2D u_Texture;\nuniform float u_SensorAngle;\nuniform float u_SensorDist;\n\n/* Outputs. These mirror the inputs. These values will be captured\n   into our transform feedback buffer! */\nout vec2 v_Position;\nout vec2 v_Velocity;\n\nvec2 rotate(vec2 v, float theta) {\n    float s = sin(theta);\n    float c = cos(-theta);\n    return vec2(\n        v.x * c + (v.y * s * -1.),\n        v.x * s + v.y * c);\n}\n\nvec2 sense(vec2 p, vec2 v, float dist, float theta) {\n    vec2 ratio = dist / u_Size;\n    vec2 c = normalize(v / ratio);\n    vec2 r = rotate(c, -theta) * ratio;\n    vec2 l = rotate(c, theta) * ratio;\n    c *= ratio;\n//    return vec2(ratio.x, ratio.y) / c;\n    vec2 wp = vec2(mod(p.x, 1.0), mod(p.y, 1.0));\n    float ct = texture(u_Texture, wp + c).r;\n    float rt = texture(u_Texture, wp + r).r;\n    float lt = texture(u_Texture, wp + l).r;\n\n    // detect any obstruction ahead\n    float front = texture(u_Texture, wp + c).r;\n    if (front > 0.99) {\n        ivec2 p = ivec2(i_Position.x * 255.0, i_Position.y * 255.0);\n        float rand = texelFetch(u_Random, p, 0).r;\n        return rand < 0.5 ? l : r;// l * length(v);\n    }\n\n    if (ct > lt && ct > rt) {\n        // keep going straight\n        return c;\n    }\n    if (ct < lt && ct < rt) {\n        // random direction change\n        ivec2 p = ivec2(i_Position.x * 255.0, i_Position.y * 255.0);\n        float rand = texelFetch(u_Random, p, 0).r;\n        return rand < 0.5 ? l : r;// l * length(v);\n    }\n    if (lt < rt) {\n        // turn right\n        return r;\n    }\n    if (lt > rt) {\n        return l;\n    }\n    return c;\n}\n\nvoid main() {\n    vec2 newDir = sense(i_Position, i_Velocity, u_SensorDist, u_SensorAngle);\n    vec2 updated = i_Position + newDir * u_TimeDelta;// * u_TimeDelta * 2.);\n    v_Position = vec2(mod(updated.x, 1.0), mod(updated.y, 1.0));//cur.r > 0.3 ? i_Position : vec2(mod(updated.x, 1.0), mod(updated.y, 1.0));\n    v_Velocity = newDir;// cur.r > 0.3 ? i_Velocity * -1. : i_Velocity;\n}\n"),t("#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nvoid main() { discard; }\n")],{transformFeedbackVaryings:["v_Position","v_Velocity"],transformFeedbackMode:e.INTERLEAVED_ATTRIBS});console.log(o);const i=Ct(e,[t("#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nlayout (location = 1) in vec2 i_Position;\nlayout (location = 2) in vec2 i_Velocity;\n\nuniform float width;\nuniform float height;\n\nout vec2 v_TexCoord;\n\nvoid main() {\n    gl_PointSize = 1.;\n    v_TexCoord = i_Position;\n    gl_Position = vec4(i_Position * 2.0 - 1.0, 0.0, 1.0);\n}\n"),t("#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nin vec2 v_TexCoord;\nout vec4 o_FragColor;\n\nvoid main() {\n    float v = 1.0;\n//    o_FragColor = vec4(c.rgb + 0.01, 1.0);\n    o_FragColor = vec4(v, v, v, 1.0);\n//    o_FragColor = vec4(u_Texture, 1.0);\n}\n")]);console.log(i);const a=new Float32Array(function(e){const t=[];for(let r=0;r<e;++r)t.push(.5+.6*(Math.random()-.5)),t.push(.5+.6*(Math.random()-.5)),t.push(.01*(Math.random()-.5)),t.push(.01*(Math.random()-.5));return t}(n)),u=Array.from({length:2}).map((()=>_(e,a,e.ARRAY_BUFFER,e.STREAM_DRAW))),s=je(e,{src:jt,format:e.R8,internalFormat:e.R8,wrap:e.MIRRORED_REPEAT,level:0,min:e.NEAREST}),l=r.map((t=>je(e,{src:t,format:e.RGBA,internalFormat:e.RGBA,wrap:e.CLAMP_TO_EDGE,level:0,min:e.LINEAR,flipY:!0}))),c=u.map((t=>L(e,{i_Position:{numComponents:2,buffer:t,type:e.FLOAT,stride:16},i_Velocity:{numComponents:2,buffer:t,type:e.FLOAT,stride:16,offset:8}}))).map((e=>(e.numElements=n,e))),f=u.map((t=>L(e,{i_Position:{numComponents:2,buffer:t,type:e.FLOAT,stride:16}}))).map((e=>(e.numElements=n,e)));console.log("updateBufferInfos"),console.log(c),console.log("renderBufferInfos"),console.log(f);const m=[Lt(e,o,c[0]),Lt(e,o,c[1]),Lt(e,i,f[0]),Lt(e,i,f[1])];e.bindBuffer(e.ARRAY_BUFFER,null);const d=[{format:e.RGBA,type:e.UNSIGNED_BYTE,min:e.NEAREST,wrap:e.REPEAT,level:0}],p=[zt(e,d),zt(e,d),zt(e,d)];e.bindFramebuffer(e.FRAMEBUFFER,null);const y=Ct(e,[t("#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nin vec2 i_Position;\n// a varying to pass the texture coordinates to the fragment shader\nout vec2 v_Texcoord;\n\nvoid main() {\n    gl_Position = vec4(i_Position, 0, 1);\n    v_Texcoord = (i_Position + 1.0) / 2.;\n}\n"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nin vec2 v_Texcoord;\n\nuniform sampler2D u_Texture;\nuniform sampler2D u_Previous;\nuniform sampler2D u_Extra;\nuniform float u_Width;\nuniform float u_Height;\nuniform float u_Decay;\n\nout vec4 outColor;\n\nvoid main() {\n    //    outColor = texture(u_Texture, v_Texcoord + 0.5);\n    ivec2 p = ivec2(v_Texcoord.x * u_Width, v_Texcoord.y * u_Height);\n    int w = int(u_Width);\n    int h = int(u_Height);\n    float t = 0.1;\n    for (int i = -1; i < 2; i++) {\n        for (int j = -1; j < 2; j++) {\n            int x = (w + p.x + i) % w;\n            int y = (h + p.y + j) % h;\n            t += texelFetch(u_Previous, ivec2(x, y), 0).r;\n        }\n    }\n    t = clamp((t / 9.0) - u_Decay, 0., 1.);\n\n    float c = texelFetch(u_Texture, p, 0).r;\n    if (u_Decay > 0.0) {\n        float v = texture(u_Extra, v_Texcoord).r;\n        if (v > 0.0) {\n            outColor = vec4(0.7);\n            return;\n        }\n\n    }\n    outColor = vec4(t + c, t + c, t + c, 1.0);\n    //    outColor = vec4(1.,0.0,1.,1.0);\n}\n")]);console.log(y);const b=L(e,{i_Position:{numComponents:2,data:[-1,1,-1,-1,1,-1,1,1]},indices:{numComponents:2,data:[3,2,1,3,1,0]}}),h=Lt(e,y,b);return e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.depthMask(!1),e.clear(e.COLOR_BUFFER_BIT),{num:n,read:0,write:1,updateProgram:o,updateBufferInfos:c,renderProgram:i,renderBufferInfos:f,oldTime:0,totalTime:0,vaos:m,fbis:p,displayTextureProgram:y,displayTextureBufferInfo:b,displayTextureVao:h,randomTexture:s,imageTextures:l}}function Wt(e,t,r){t.oldTime=r,e.clear(e.COLOR_BUFFER_BIT),Ot(e.canvas),e.viewport(0,0,e.canvas.width,e.canvas.height),e.useProgram(t.updateProgram.program),Rt(e,t.updateProgram,t.vaos[t.read]),Tt(t.updateProgram,{u_Texture:t.fbis[t.write].attachments[0],u_TimeDelta:.01666,u_Random:t.randomTexture,u_Size:[e.canvas.width,e.canvas.height],u_SensorAngle:kt.sensorAngle,u_SensorDist:kt.sensorDist}),e.enable(e.BLEND),e.enable(e.RASTERIZER_DISCARD);const n=t.updateBufferInfos[t.write].attribs.i_Velocity.buffer,o=(Math.floor(t.num/65536),t.num<65535?t.num:65535);e.bindBufferRange(e.TRANSFORM_FEEDBACK_BUFFER,0,n,16*o,16*(t.num-o)),e.beginTransformFeedback(e.POINTS),Bt(e,t.vaos[t.read],e.POINTS,t.num-o,o),e.endTransformFeedback(),e.bindBufferRange(e.TRANSFORM_FEEDBACK_BUFFER,0,n,0,16*o),e.beginTransformFeedback(e.POINTS),Bt(e,t.vaos[t.read],e.POINTS,o,0),e.endTransformFeedback(),e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,0,null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindVertexArray(null),e.disable(e.RASTERIZER_DISCARD),e.bindFramebuffer(e.FRAMEBUFFER,t.fbis[2].framebuffer),Ot(e.canvas),e.viewport(0,0,e.canvas.width,e.canvas.height),e.useProgram(t.renderProgram.program),Rt(e,t.renderProgram,t.vaos[t.read+2]),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),Bt(e,t.vaos[t.read+2],e.POINTS),e.bindVertexArray(null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.useProgram(t.displayTextureProgram.program),e.bindFramebuffer(e.FRAMEBUFFER,t.fbis[t.write].framebuffer),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),Ot(e.canvas),e.viewport(0,0,e.canvas.width,e.canvas.height),Rt(e,t.displayTextureProgram,t.displayTextureBufferInfo),Tt(t.displayTextureProgram,{u_Texture:t.fbis[2].attachments[0],u_Previous:t.fbis[t.read].attachments[0],u_Extra:t.imageTextures[kt.imageToShow],u_Decay:kt.decay,u_Width:e.canvas.width,u_Height:e.canvas.height}),e.disable(e.BLEND),Bt(e,t.displayTextureVao),e.bindVertexArray(null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),Ot(e.canvas),e.viewport(0,0,e.canvas.width,e.canvas.height),Rt(e,t.displayTextureProgram,t.displayTextureBufferInfo),Tt(t.displayTextureProgram,{u_Texture:t.fbis[2].attachments[0],u_Previous:kt.showEnvironment?t.fbis[t.write].attachments[0]:t.fbis[2].attachments[0],u_Width:e.canvas.width,u_Height:e.canvas.height,u_Decay:0}),e.disable(e.BLEND),Bt(e,t.displayTextureVao),e.bindVertexArray(null);let i=t.read;t.read=t.write,t.write=i}!function(){document.getElementById("image-switch").addEventListener("click",(()=>{kt.imageToShow=(kt.imageToShow+1)%2}));const e=document.getElementById("angle"),t=document.getElementById("distance"),r=document.getElementById("decay");e.value=kt.sensorAngle,t.value=kt.sensorDist,r.value=kt.decay,e.addEventListener("input",Nt("sensorAngle")),t.addEventListener("input",Nt("sensorDist")),r.addEventListener("input",Nt("decay"))}(),window.onload=async function(){const e=document.createElement("canvas");e.width=window.innerWidth,e.height=window.innerHeight,console.log(e.width,e.height);const r=e.getContext("webgl2",{premultipliedAlpha:!1,alpha:!1});if(console.log(r.getParameter(r.MAX_ELEMENT_INDEX)),console.log(r.getParameter(r.MAX_ELEMENTS_VERTICES)),console.log(r.getParameter(r.MAX_ELEMENTS_INDICES)),console.log(r.getParameter(r.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)),null!=r){document.body.appendChild(e);const n=await Vt(t(u)),o=await Vt(t(a)),i=Ht(r,[n,o]),s=e=>{Wt(r,i,e),Wt(r,i,e),window.requestAnimationFrame((function(e){s(e)}))};window.requestAnimationFrame((function(e){s(e)}))}else document.write("WebGL2 is not supported by your browser")};
//# sourceMappingURL=index.ecd37f9d.js.map
